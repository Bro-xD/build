import"../chunks/Bg9kRutz.js";import{p as ot,aa as _,ac as f,ab as x,ad as d,ae as ht,o as P,a as ct,r as k,ag as De,D as xt}from"../chunks/SCCXHowg.js";import{d as lt,s as ve}from"../chunks/C5uFnDi8.js";import{i as bt}from"../chunks/DYuL35ex.js";import{t as A,a as q,c as It}from"../chunks/BiEH_QtQ.js";import{c as M}from"../chunks/CbBtwccj.js";import{p as D}from"../chunks/DuCrL0rR.js";import{s as T,a as ut}from"../chunks/BvtbGinx.js";import{p as dt}from"../chunks/bHicRhf0.js";import{g as me}from"../chunks/CLZ_woKs.js";import{o as ft}from"../chunks/DcgF8Xjn.js";import{u as gt}from"../chunks/DDHdIOpt.js";import{e as St,i as wt,g as Dt}from"../chunks/BFnjxXbk.js";import{s as qe}from"../chunks/Dj7PeN45.js";import{s as qt}from"../chunks/DCcHWOLs.js";import{a as Re}from"../chunks/B5Ja7Ssa.js";import{C as Rt,T as N,G as Et}from"../chunks/B9cRJPy6.js";import{O as kt}from"../chunks/DTbTwHK6.js";import"../chunks/x_O8n_hi.js";var Tt=(e,t,i)=>t(P(i).key),At=A('<button><img width="50" height="50"> <div class="text-center text-xs text-gray-700"> </div></button>'),Gt=A('<div class="flex gap-4 mt-5 justify-center"></div>');function _t(e,t){ot(t,!0);const[i,a]=ut(),o=()=>T(dt,"$page",i),n=()=>T(gt,"$userInfo",i);let r=_(null),h=_(D({}));o().params.id;let s=n()?JSON.parse(n()):null;const g=[{key:"happy",src:"/emoji/happy.gif"},{key:"cool",src:"/emoji/cool.gif"},{key:"angel",src:"/emoji/angel.gif"},{key:"confeti",src:"/emoji/confeti.gif"},{key:"anger",src:"/emoji/end.gif"}];let c=_(null);function y(C){const l={};for(const m of Object.values(C))l[m]=(l[m]||0)+1;return l}async function u(){const l=await(await Re.get(`api/reaction/${s.refuge.id}`)).json();k(h,D(y(JSON.parse(l)))),k(c,D(JSON.parse(l)[s.user.id]||null))}async function v(C){k(r,null),k(c,D(C)),await Re.post("api/reaction",{json:{emoji:C,userId:s.user.id,refugeId:s.refuge.id}}),await u()}ft(()=>{u()});var p=Gt();St(p,21,()=>g,wt,(C,l)=>{var m=At();m.__click=[Tt,v,l];var I=f(m),R=x(I,2),S=f(R,!0);d(R),d(m),ht(()=>{qt(m,`emoji-button ${(P(r)===P(l).key||P(c)===P(l).key?"emoji-selected":"")??""} svelte-31bg9`),qe(I,"src",P(l).src),qe(I,"alt",P(l).key),ve(S,P(h)[P(l).key]||0)}),q(C,m)}),d(p),q(e,p),ct(),a()}lt(["click"]);var $,Ee;function Mt(){return Ee||(Ee=1,$=function(e){var t=e-this.previousTimeStamp>100,i=this.states[this.activeState].loop!==void 0?this.states[this.activeState].loop:!0,a,o,n;(this.previousTimeStamp===null||t)&&(this.previousTimeStamp=e),this.progress=this.progress+(e-this.previousTimeStamp),a=(this.progress/this.activetransitionSpeed*100).toFixed(2),this.previousTimeStamp=e,this.refreshColorsAndPos(a),a<100?this.animation=requestAnimationFrame(this.animateColors.bind(this)):this.channelsIndex<this.states[this.activeState].gradients.length-2||i?(this.isChangingState&&(this.activetransitionSpeed=this.states[this.activeState].transitionSpeed||5e3,this.isChangingState=!1),this.previousTimeStamp=null,this.progress=0,this.channelsIndex++,o=!1,this.channelsIndex===this.states[this.activeState].gradients.length-1?o=!0:this.channelsIndex===this.states[this.activeState].gradients.length&&(this.channelsIndex=0),n=this.states[this.activeState].gradients[this.channelsIndex+1]===void 0?this.states[this.activeState].gradients[0]:this.states[this.activeState].gradients[this.channelsIndex+1],this.setColors(),this.animation=requestAnimationFrame(this.animateColors.bind(this)),this.callbacks.onGradientChange&&this.callbacks.onGradientChange({isLooping:o,colorsFrom:this.states[this.activeState].gradients[this.channelsIndex],colorsTo:n,activeState:this.activeState}),this.canvas.dispatchEvent(this.events.gradientChange({isLooping:o,colorsFrom:this.states[this.activeState].gradients[this.channelsIndex],colorsTo:n,activeState:this.activeState}))):(cancelAnimationFrame(this.animation),this.callbacks.onEnd&&this.callbacks.onEnd(),this.canvas.dispatchEvent(new CustomEvent("granim:end")))}),$}var O,ke;function Nt(){return ke||(ke=1,O=function(e){this.context.clearRect(0,0,this.x1,this.y1),this.context.globalCompositeOperation=this.image.blendingMode=e,this.validateInput("blendingMode"),this.isPaused&&this.refreshColorsAndPos()}),O}var L,Te;function $t(){return Te||(Te=1,L=function(e){this.context.clearRect(0,0,this.x1,this.y1),this.direction=e,this.validateInput("direction"),this.isPaused&&this.refreshColorsAndPos()}),L}var V,Ae;function Ot(){return Ae||(Ae=1,V=function(e){var t=this;this.activeState!==e&&(this.isPaused||(this.isPaused=!0,this.pause()),this.channelsIndex=-1,this.activetransitionSpeed=this.stateTransitionSpeed,this.activeColorsDiff=[],this.activeColorsPosDiff=[],this.activeColors=this.getCurrentColors(),this.activeColorsPos=this.getCurrentColorsPos(),this.progress=0,this.previousTimeStamp=null,this.isChangingState=!0,this.states[e].gradients[0].forEach(function(i,a,o){var n=t.convertColorToRgba(t.getColor(i)),r=t.getColorPos(i,a),h=t.getColorDiff(t.activeColors[a],n),s=t.getColorPosDiff(t.activeColorsPos[a],r);t.activeColorsDiff.push(h),t.activeColorsPosDiff.push(s)}),this.activeState=e,this.play())}),V}var W,Ge;function Lt(){return Ge||(Ge=1,W=function(){this.isPaused?this.isPaused=!1:cancelAnimationFrame(this.animation),this.isCleared=!0,this.context.clearRect(0,0,this.x1,this.y1)}),W}var F,_e;function Vt(){if(_e)return F;_e=1;var e={hexa:/^#(?:[0-9a-fA-F]{3}){1,2}$/,rgba:/^rgba\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3}), ?(.?\d{1,3})\)$/,rgb:/^rgb\((\d{1,3}), ?(\d{1,3}), ?(\d{1,3})\)$/,hsla:/^hsla\((\d{1,3}), ?(\d{1,3})%, ?(\d{1,3})%, ?(.?\d{1,3})\)$/,hsl:/^hsl\((\d{1,3}), ?(\d{1,3})%, ?(\d{1,3})%\)$/},t;F=function(r){switch(i(r)){default:this.triggerError("colorType");case"hexa":return a(r);case"rgba":return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4])];case"rgb":return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),1];case"hsla":return n(parseInt(t[1],10)/360,parseInt(t[2],10)/100,parseInt(t[3],10)/100,parseFloat(t[4]));case"hsl":return n(parseInt(t[1],10)/360,parseInt(t[2],10)/100,parseInt(t[3],10)/100,1)}};function i(r){var h=Object.keys(e),s=0;for(s;s<h.length;s++)if(t=e[h[s]].exec(r),t)return h[s];return!1}function a(r){var h=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;r=r.replace(h,function(g,c,y,u){return c+c+y+y+u+u});var s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return s?[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16),1]:null}function o(r,h,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?r+(h-r)*6*s:s<1/2?h:s<2/3?r+(h-r)*(2/3-s)*6:r}function n(r,h,s,g){var c,y,u,v,p;return h===0?c=y=u=s:(v=s<.5?s*(1+h):s+h-s*h,p=2*s-v,c=o(p,v,r+1/3),y=o(p,v,r),u=o(p,v,r-1/3)),[Math.round(c*255),Math.round(y*255),Math.round(u*255),g]}return F}var j,Me;function Wt(){return Me||(Me=1,j=function(){this.onResize("removeListeners"),this.onScroll("removeListeners"),this.clear()}),j}var B,Ne;function Ft(){return Ne||(Ne=1,B=function(){if(typeof window.CustomEvent=="function")return;function e(t,i){i=i||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(t,i.bubbles,i.cancelable,i.detail),a}e.prototype=window.Event.prototype,window.CustomEvent=e}),B}var z,$e;function jt(){return $e||($e=1,z=function(e){if(typeof e=="string")return e;if(typeof e=="object"&&e.color)return e.color;this.triggerError("gradient.color")}),z}var H,Oe;function Bt(){return Oe||(Oe=1,H=function(e,t){var i=0,a=[];for(i;i<4;i++)a.push(t[i]-e[i]);return a}),H}var J,Le;function zt(){return Le||(Le=1,J=function(e,t){return typeof e=="object"&&e.pos?e.pos:parseFloat(t?(1/(this.gradientLength-1)*t).toFixed(2):0)}),J}var U,Ve;function Ht(){return Ve||(Ve=1,U=function(e,t){return t-e}),U}var K,We;function Jt(){return We||(We=1,K=function(){var e,t,i=[];for(e=0;e<this.currentColors.length;e++)for(i.push([]),t=0;t<4;t++)i[e].push(this.currentColors[e][t]);return i}),K}var Q,Fe;function Ut(){return Fe||(Fe=1,Q=function(){var e=[],t;for(t=0;t<this.currentColorsPos.length;t++)e.push(this.currentColorsPos[t]);return e}),Q}var X,je;function Kt(){return je||(je=1,X=function(){this.x1=this.canvas.offsetWidth,this.y1=this.canvas.offsetHeight}),X}var Y,Be;function Qt(){return Be||(Be=1,Y=function(e){if(e instanceof HTMLCanvasElement)this.canvas=e;else if(typeof e=="string")this.canvas=document.querySelector(e);else throw new Error("The element you used is neither a String, nor a HTMLCanvasElement");if(!this.canvas)throw new Error("`"+e+"` could not be found in the DOM")}),Y}var Z,ze;function Xt(){return ze||(ze=1,Z=function(){var e=this.getCurrentColors(),t=null,i,a,o=e.map(function(n){return Math.max(n[0],n[1],n[2])});for(a=0;a<o.length;a++)t=t===null?o[a]:t+o[a],a===o.length-1&&(i=Math.round(t/(a+1)));return i>=128?"light":"dark"}),Z}var ee,He;function Yt(){return He||(He=1,ee=function(){var e=this.setDirection(),t=document.querySelector(this.elToSetClassOn).classList,i=0;for(this.context.clearRect(0,0,this.x1,this.y1),this.image&&this.context.drawImage(this.imageNode,this.imagePosition.x,this.imagePosition.y,this.imagePosition.width,this.imagePosition.height),i;i<this.currentColors.length;i++)e.addColorStop(this.currentColorsPos[i],"rgba("+this.currentColors[i][0]+", "+this.currentColors[i][1]+", "+this.currentColors[i][2]+", "+this.currentColors[i][3]+")");this.name&&(this.getLightness()==="light"?(t.remove(this.name+"-dark"),t.add(this.name+"-light")):(t.remove(this.name+"-light"),t.add(this.name+"-dark"))),this.context.fillStyle=e,this.context.fillRect(0,0,this.x1,this.y1)}),ee}var te,Je;function Zt(){return Je||(Je=1,te=function(e){if(e==="removeListeners"){window.removeEventListener("resize",this.setSizeAttributesNameSpace);return}window.addEventListener("resize",this.setSizeAttributesNameSpace)}),te}var ie,Ue;function ei(){return Ue||(Ue=1,ie=function(e){if(e==="removeListeners"){window.removeEventListener("scroll",this.pauseWhenNotInViewNameSpace);return}window.addEventListener("scroll",this.pauseWhenNotInViewNameSpace),this.pauseWhenNotInViewNameSpace()}),ie}var re,Ke;function ti(){return Ke||(Ke=1,re=function(e){var t=e==="isPausedBecauseNotInView";this.isCleared||(t||(this.isPaused=!0),cancelAnimationFrame(this.animation),this.animating=!1)}),re}var se,Qe;function ii(){return Qe||(Qe=1,se=function(){var e=this;this.scrollDebounceTimeout&&clearTimeout(this.scrollDebounceTimeout),this.scrollDebounceTimeout=setTimeout(function(){var t=e.canvas.getBoundingClientRect();if(e.isCanvasInWindowView=!(t.bottom<0||t.right<0||t.left>window.innerWidth||t.top>window.innerHeight),e.isCanvasInWindowView){if(!e.isPaused||e.firstScrollInit){if(e.image&&!e.isImgLoaded)return;e.isPausedBecauseNotInView=!1,e.play("isPlayedBecauseInView"),e.firstScrollInit=!1}}else!e.image&&e.firstScrollInit&&(e.refreshColorsAndPos(),e.firstScrollInit=!1),!e.isPaused&&!e.isPausedBecauseNotInView&&(e.isPausedBecauseNotInView=!0,e.pause("isPausedBecauseNotInView"))},this.scrollDebounceThreshold)}),se}var ne,Xe;function ri(){return Xe||(Xe=1,ne=function(e){var t=e==="isPlayedBecauseInView";t||(this.isPaused=!1),this.isCleared=!1,this.animating||(this.animation=requestAnimationFrame(this.animateColors.bind(this)),this.animating=!0)}),ne}var ae,Ye;function si(){return Ye||(Ye=1,ae=function(){var e=this;if(this.imagePosition||(this.imagePosition={x:0,y:0,width:0,height:0}),this.image.blendingMode&&(this.context.globalCompositeOperation=this.image.blendingMode),this.imageNode){t();return}this.imageNode=new Image,this.imageNode.onerror=function(){throw new Error("Granim: The image source is invalid.")},this.imageNode.onload=function(){e.imgOriginalWidth=e.imageNode.width,e.imgOriginalHeight=e.imageNode.height,t(),e.refreshColorsAndPos(),(!e.isPausedWhenNotInView||e.isCanvasInWindowView)&&(e.animation=requestAnimationFrame(e.animateColors.bind(e))),e.isImgLoaded=!0},this.imageNode.src=this.image.source;function t(){var i,a;for(i=0;i<2;i++)a=i?"y":"x",o(a);function o(n){var r=e[n+"1"],h=e[n==="x"?"imgOriginalWidth":"imgOriginalHeight"],s=n==="x"?e.image.position[0]:e.image.position[1],g;switch(s){case"center":g=h>r?-(h-r)/2:(r-h)/2,e.imagePosition[n]=g,e.imagePosition[n==="x"?"width":"height"]=h;break;case"top":e.imagePosition.y=0,e.imagePosition.height=h;break;case"bottom":e.imagePosition.y=r-h,e.imagePosition.height=h;break;case"right":e.imagePosition.x=r-h,e.imagePosition.width=h;break;case"left":e.imagePosition.x=0,e.imagePosition.width=h;break}if(e.image.stretchMode)switch(s=n==="x"?e.image.stretchMode[0]:e.image.stretchMode[1],s){case"none":break;case"stretch":e.imagePosition[n]=0,e.imagePosition[n==="x"?"width":"height"]=r;break;case"stretch-if-bigger":if(h<r)break;e.imagePosition[n]=0,e.imagePosition[n==="x"?"width":"height"]=r;break;case"stretch-if-smaller":if(h>r)break;e.imagePosition[n]=0,e.imagePosition[n==="x"?"width":"height"]=r;break}}}}),ae}var oe,Ze;function ni(){return Ze||(Ze=1,oe=function(e){var t=this,i,a,o,n;for(o=0;o<this.activeColors.length;o++){for(n=0;n<4;n++)i=t.activeColors[o][n]+(n!==3?Math.ceil(t.activeColorsDiff[o][n]/100*e):Math.round(t.activeColorsDiff[o][n]/100*e*100)/100),i<=255&&i>=0&&(t.currentColors[o][n]=i);a=parseFloat((t.activeColorsPos[o]+t.activeColorsPosDiff[o]/100*e).toFixed(4)),a<=1&&a>=0&&(t.currentColorsPos[o]=a)}this.makeGradient()}),oe}var he,et;function ai(){return et||(et=1,he=function(){var e=this,t,i,a,o;if(this.channels[this.activeState]||(this.channels[this.activeState]=[]),this.channels[this.activeState][this.channelsIndex]!==void 0){this.activeColors=this.channels[this.activeState][this.channelsIndex].colors,this.activeColorsDiff=this.channels[this.activeState][this.channelsIndex].colorsDiff,this.activeColorsPos=this.channels[this.activeState][this.channelsIndex].colorsPos,this.activeColorsPosDiff=this.channels[this.activeState][this.channelsIndex].colorsPosDiff;return}this.channels[this.activeState].push([{}]),this.channels[this.activeState][this.channelsIndex].colors=[],this.channels[this.activeState][this.channelsIndex].colorsDiff=[],this.channels[this.activeState][this.channelsIndex].colorsPos=[],this.channels[this.activeState][this.channelsIndex].colorsPosDiff=[],this.activeColors=[],this.activeColorsDiff=[],this.activeColorsPos=[],this.activeColorsPosDiff=[],this.states[this.activeState].gradients[this.channelsIndex].forEach(function(s,r){var h=e.getColorPos(s,r),s=e.getColor(s),g=e.convertColorToRgba(s),c=e.channels[e.activeState];c[e.channelsIndex].colors.push(g),e.activeColors.push(g),c[e.channelsIndex].colorsPos.push(h),e.activeColorsPos.push(h),e.isCurrentColorsSet||(e.currentColors.push(e.convertColorToRgba(s)),e.currentColorsPos.push(h)),e.channelsIndex===e.states[e.activeState].gradients.length-1?(t=e.getColorDiff(c[e.channelsIndex].colors[r],c[0].colors[r]),i=e.getColorPosDiff(c[e.channelsIndex].colorsPos[r],c[0].colorsPos[r])):(a=e.convertColorToRgba(e.getColor(e.states[e.activeState].gradients[e.channelsIndex+1][r])),o=e.getColorPos(e.states[e.activeState].gradients[e.channelsIndex+1][r],r),t=e.getColorDiff(c[e.channelsIndex].colors[r],a),i=e.getColorPosDiff(c[e.channelsIndex].colorsPos[r],o)),c[e.channelsIndex].colorsDiff.push(t),e.activeColorsDiff.push(t),c[e.channelsIndex].colorsPosDiff.push(i),e.activeColorsPosDiff.push(i)}),this.activetransitionSpeed=this.states[this.activeState].transitionSpeed||5e3,this.isCurrentColorsSet=!0}),he}var ce,tt;function oi(){if(tt)return ce;tt=1,ce=function(){var t=this.context;switch(this.direction){case"diagonal":return t.createLinearGradient(0,0,this.x1,this.y1);case"left-right":return t.createLinearGradient(0,0,this.x1,0);case"top-bottom":return t.createLinearGradient(this.x1/2,0,this.x1/2,this.y1);case"radial":return t.createRadialGradient(this.x1/2,this.y1/2,this.x1/2,this.x1/2,this.y1/2,0);case"custom":return t.createLinearGradient(e(this.customDirection.x0,this.x1),e(this.customDirection.y0,this.y1),e(this.customDirection.x1,this.x1),e(this.customDirection.y1,this.y1))}};function e(t,i){return t.indexOf("%")>-1?i/100*parseInt(t.split("%")[0],10):parseInt(t.split("px")[0],10)}return ce}var le,it;function hi(){return it||(it=1,le=function(){this.getDimensions(),this.canvas.setAttribute("width",this.x1),this.canvas.setAttribute("height",this.y1),this.image&&this.prepareImage(),this.refreshColorsAndPos()}),le}var ue,rt;function ci(){return rt||(rt=1,ue=function(e){var t="https://sarcadass.github.io/granim.js/api.html";throw new Error('Granim: Input error on "'+e+`" option.
Check the API `+t+".")}),ue}var de,st;function li(){if(st)return de;st=1,de=function(t){var i=["left","center","right"],a=["top","center","bottom"],o=["none","stretch","stretch-if-smaller","stretch-if-bigger"],n=["multiply","screen","normal","overlay","darken","lighten","lighter","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],r=["diagonal","left-right","top-bottom","radial","custom"];switch(t){case"image":(!Array.isArray(this.image.position)||this.image.position.length!==2||i.indexOf(this.image.position[0])===-1||a.indexOf(this.image.position[1])===-1)&&this.triggerError("image.position"),this.image.stretchMode&&(!Array.isArray(this.image.stretchMode)||this.image.stretchMode.length!==2||o.indexOf(this.image.stretchMode[0])===-1||o.indexOf(this.image.stretchMode[1])===-1)&&this.triggerError("image.stretchMode");break;case"blendingMode":n.indexOf(this.image.blendingMode)===-1&&(this.clear(),this.triggerError("blendingMode"));break;case"direction":r.indexOf(this.direction)===-1?this.triggerError("direction"):this.direction==="custom"&&(e([this.customDirection.x0,this.customDirection.x1,this.customDirection.y0,this.customDirection.y1])||this.triggerError("customDirection"));break}};function e(t){for(var i=!0,a=0,o;i&&a<t.length;){if(o=t[a],typeof o!="string")i=!1;else{var n=null,r=null;o.indexOf("px")!==-1&&(r="px"),o.indexOf("%")!==-1&&(r="%"),n=o.split(r).filter(function(h){return h.length>0}),(!r||n.length>2||!n[0]||n[1]||!/^-?\d+\.?\d*$/.test(n[0]))&&(i=!1)}a++}return i}return de}var fe,nt;function ui(){if(nt)return fe;nt=1;function e(t){this.getElement(t.element),this.x1=0,this.y1=0,this.name=t.name||!1,this.elToSetClassOn=t.elToSetClassOn||"body",this.direction=t.direction||"diagonal",this.customDirection=t.customDirection||{},this.validateInput("direction"),this.isPausedWhenNotInView=t.isPausedWhenNotInView||!1,this.states=t.states,this.stateTransitionSpeed=t.stateTransitionSpeed||1e3,this.previousTimeStamp=null,this.progress=0,this.isPaused=!1,this.isCleared=!1,this.isPausedBecauseNotInView=!1,this.context=this.canvas.getContext("2d"),this.channels={},this.channelsIndex=0,this.activeState=t.defaultStateName||"default-state",this.isChangingState=!1,this.currentColors=[],this.currentColorsPos=[],this.activetransitionSpeed=null,this.eventPolyfill(),this.scrollDebounceThreshold=t.scrollDebounceThreshold||300,this.scrollDebounceTimeout=null,this.isImgLoaded=!1,this.isCanvasInWindowView=!1,this.firstScrollInit=!0,this.animating=!1,this.gradientLength=this.states[this.activeState].gradients[0].length,t.image&&t.image.source&&(this.image={source:t.image.source,position:t.image.position||["center","center"],stretchMode:t.image.stretchMode||!1,blendingMode:t.image.blendingMode||!1}),this.events={start:new CustomEvent("granim:start"),end:new CustomEvent("granim:end"),gradientChange:function(i){return new CustomEvent("granim:gradientChange",{detail:{isLooping:i.isLooping,colorsFrom:i.colorsFrom,colorsTo:i.colorsTo,activeState:i.activeState},bubbles:!1,cancelable:!1})}},this.callbacks={onStart:typeof t.onStart=="function"?t.onStart:!1,onGradientChange:typeof t.onGradientChange=="function"?t.onGradientChange:!1,onEnd:typeof t.onEnd=="function"?t.onEnd:!1},this.getDimensions(),this.canvas.setAttribute("width",this.x1),this.canvas.setAttribute("height",this.y1),this.setColors(),this.image&&(this.validateInput("image"),this.prepareImage()),this.pauseWhenNotInViewNameSpace=this.pauseWhenNotInView.bind(this),this.setSizeAttributesNameSpace=this.setSizeAttributes.bind(this),this.onResize(),this.isPausedWhenNotInView?this.onScroll():this.image||(this.refreshColorsAndPos(),this.animation=requestAnimationFrame(this.animateColors.bind(this)),this.animating=!0),this.callbacks.onStart&&this.callbacks.onStart(),this.canvas.dispatchEvent(this.events.start)}return e.prototype.animateColors=Mt(),e.prototype.changeBlendingMode=Nt(),e.prototype.changeDirection=$t(),e.prototype.changeState=Ot(),e.prototype.clear=Lt(),e.prototype.convertColorToRgba=Vt(),e.prototype.destroy=Wt(),e.prototype.eventPolyfill=Ft(),e.prototype.getColor=jt(),e.prototype.getColorDiff=Bt(),e.prototype.getColorPos=zt(),e.prototype.getColorPosDiff=Ht(),e.prototype.getCurrentColors=Jt(),e.prototype.getCurrentColorsPos=Ut(),e.prototype.getDimensions=Kt(),e.prototype.getElement=Qt(),e.prototype.getLightness=Xt(),e.prototype.makeGradient=Yt(),e.prototype.onResize=Zt(),e.prototype.onScroll=ei(),e.prototype.pause=ti(),e.prototype.pauseWhenNotInView=ii(),e.prototype.play=ri(),e.prototype.prepareImage=si(),e.prototype.refreshColorsAndPos=ni(),e.prototype.setColors=ai(),e.prototype.setDirection=oi(),e.prototype.setSizeAttributes=hi(),e.prototype.triggerError=ci(),e.prototype.validateInput=li(),fe=e,fe}var ge,at;function di(){return at||(at=1,ge=ui()),ge}var fi=di();const gi=Dt(fi);var vi=(e,t)=>me(`/refuge/${t}`),mi=A("<!> <!> <!> <!>",1),pi=A('<div class="flex gap-5 style--bg svelte-2naiyw"><div class="refuge-container w-[900px] mx-auto border-x border-gray-400 p-5 relative text-gray-600 svelte-2naiyw"><div class="w-full h-[300px] relative svelte-2naiyw"><canvas id="granim-canvas" style="position: absolute; width: 100%; height: 100%;" class="rounded-lg svelte-2naiyw"></canvas> <div class="c--refuge flex m-4 gap-4  svelte-2naiyw"><div class="refuge--name text-4xl font-extrabold text-white svelte-2naiyw"> </div> <button class="btn-refuge   svelte-2naiyw">Mon réfuge</button></div></div> <div class="w-[100px] h-[100px] flex justify-center -mt-16 ml-20 svelte-2naiyw"><div class="card--profil shadow-md svelte-2naiyw"><div class="card--profil2 svelte-2naiyw"><!></div></div></div> <div class="flex flex-col gap-5 mt-5 svelte-2naiyw"><div class="text-center svelte-2naiyw"><span class="animated-gradient-text svelte-2naiyw"> </span></div></div> <div class="refuge svelte-2naiyw"><!></div></div></div>');function Li(e,t){ot(t,!0);const[i,a]=ut(),o=()=>T(gt,"$userInfo",i),n=()=>T(dt,"$page",i);let r=o()?JSON.parse(o()):null,h=n().params.id??r.user.id,s=D((r==null?void 0:r.refuge)||null);ft(()=>{r?me(`/profil/${h}`,{replaceState:!0}):me("/login",{replaceState:!0});const u=new gi({element:"#granim-canvas",direction:"top-bottom",opacity:[1,1],isPausedWhenNotInView:!0,image:{source:"/images/desert.jpg",blendingMode:"hard-light"},states:{"default-state":{gradients:[[(s==null?void 0:s.primaryColor)||"#834D9B",(s==null?void 0:s.secondaryColor)||"#D04ED6"],["#1CD8D2","#93EDC7"]],transitionSpeed:2e3}}});return()=>{u.destroy()}});var g=It(),c=De(g);{var y=u=>{var v=pi(),p=f(v),C=f(p),l=x(f(C),2),m=f(l),I=f(m,!0);d(m);var R=x(m,2);R.__click=[vi,h],d(l),d(C);var S=x(C,2),pe=f(S),Ce=f(pe),vt=f(Ce);Rt(vt,{class:"",children:(E,Ci)=>{var be=mi(),Ie=De(be);M(Ie,()=>N.AmbientLight,(b,w)=>{w(b,{intensity:.6})});var Se=x(Ie,2);M(Se,()=>N.DirectionalLight,(b,w)=>{w(b,{position:[2,2,5],intensity:1})});var we=x(Se,2);M(we,()=>N.PerspectiveCamera,(b,w)=>{w(b,{fov:25,makeDefault:!0,position:[0,1.5,3],children:(Pt,yi)=>{kt(Pt,{target:[0,.9,0],autoRotate:!0,autoRotateSpeed:5})},$$slots:{default:!0}})});var Ct=x(we,2);const yt=xt(()=>{var b;return((b=r==null?void 0:r.user)==null?void 0:b.avatarConfig)||"/avatars/character-female-a.glb"});Et(Ct,{get url(){return P(yt)},scale:1,position:[0,.5,0]}),q(E,be)},$$slots:{default:!0}}),d(Ce),d(pe),d(S);var G=x(S,2),ye=f(G),Pe=f(ye),mt=f(Pe);d(Pe),d(ye),d(G);var xe=x(G,2),pt=f(xe);_t(pt,{}),d(xe),d(p),d(v),ht(()=>{var E;ve(I,s==null?void 0:s.title),ve(mt,`"${((E=r.refuge)==null?void 0:E.story)??""}"`)}),q(u,v)};bt(c,u=>{r&&u(y)})}q(e,g),ct(),a()}lt(["click"]);export{Li as component};
